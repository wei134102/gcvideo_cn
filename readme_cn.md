# GCVideo DVI 固件 #

本目录包含 GCVideo DVI 的固件源代码。

## 不推荐购买的产品列表 ##

出于可见性原因，这部分需要放在最前面。

目前有许多公司销售基于这个开源项目的设备。为了公平竞争，我倾向于不推荐任何特定产品。但是，有一些产品由于可能严重影响最终用户体验的问题，我个人不会考虑购买。

以下是我已知的不会购买的设备：

* **Hyperkin/Armor3 NuView HD**: 该设备的固件是一个修改版本，似乎基于 GCVideo 3.0 的某个发布版本。虽然截至目前尚不清楚他们修改的完整范围，但作者似乎完全移除了固件更新功能。这将导致用户被困在附带的非最新版本固件上，没有合理的更新途径。虽然作者似乎急于从 OSD 中删除所有作者信息并将版本号改为"0.1"，但他们保留了本项目的标志和名称，这导致了用户混淆，因为它与他们的产品品牌不匹配，并且没有任何真实的 GCVideo 发布版本使用过这个版本号。网上的初步报告表明，似乎没有包含任何文档，只有一个指向这个 Github 仓库子页面的链接，这可能违反了 GCVideo 项目的许可条款。

* **Bitfunx HDMI Line Doubler Adapter GC2HDMI**: 根据用户报告，该设备的供应商决定省略 IR 配置按钮。不幸的是，这个按钮是必不可少的，因为它是可靠触发 IR 遥控器配置菜单的唯一方式，也是在固件更新中断时从某些故障情况恢复的唯一方式。此外，有报告称设备外壳是胶合密封的，如果用户认为这个按钮比任何供应商保修更重要，要在 FPGA 的（非常精细的！）引脚上焊接替代品会非常困难。因此，我个人不会考虑购买这个设备。

## 构建 ##

要构建固件，你需要一个 Linux 或其他 Unix 系统，并安装 GNU make、perl 和 [ZPU gcc](http://retroramblings.net/?page_id=637)。

固件可以构建多种配置，这只影响一些菜单选项的可用性。通过使用 `TARGET` 环境变量来选择，例如输入 `make TARGET=gc-dvi`。支持的目标有：
* `gc-dvi`: Gamecube 主机的纯数字输出
* `wii-dvi`: Wii 主机的纯数字输出
* `gc-dual`: Gamecube 主机的模拟和数字双输出
* `wii-dual`: Wii 主机的模拟和数字双输出

在构建 GCVideo-DVI 的 FPGA 比特流时，会自动编译适当的固件。

## 使用 ##

GCVideo-DVI 具有用于配置其众多设置的屏幕显示(OSD)。根据运行的硬件，它支持使用 Gamecube 控制器或红外遥控器进行导航。

本手册描述了 GCVideo 的所有可用功能，但你使用的硬件可能不具备所有这些功能。例如，内部安装可能没有 IR 接收器，而数字 AV 端口的外部插头无法访问控制器。还有一些硬件变体具有额外的模拟视频输出连接器，这些变体有额外的菜单选项，在纯数字硬件上不会显示。

### 关于具有模拟输出的硬件的说明 ###

GCVideo-DV 主要设计用于提供高质量的数字视频输出，但一些硬件实现具有额外的模拟视频输出。这个输出被严格视为二等公民，它不能完全独立于主数字输出进行配置。例如，如果你启用 RGB 有限范围，这也会影响模拟输出上的信号范围（如果设置为 RGB 模式）。当模拟输出设置为 YPbPr 时，它不会受到图像设置菜单中亮度/对比度/饱和度设置的影响。

### 使用控制器 ###

屏幕显示只检查单个端口的控制器，通常是端口 1。它只在正品任天堂控制器和 Hama 克隆手柄上进行过测试。我不知道如果你连接一些更奇特的控制器会发生什么，例如邦戈鼓控制器。在 Wii 上，建议使用 IR 遥控器而不是 Gamecube 控制器，因为已观察到如果在启动时控制器端口为空，系统菜单可能不会启用控制器端口。

要激活 OSD，按住 L、R、X 和 Y 按钮直到菜单出现 - 这应该需要大约一秒钟。如果你同时按住这四个按钮和开始按钮，所有设置将重置为默认值。

OSD 使用方向键和 X、Y 按钮控制。X 按钮激活菜单项，Y 按钮在子菜单中返回上一级，或者在主菜单中完全关闭 OSD。请注意，即使 OSD 处于活动状态，Gamecube 仍会接收所有输入！这在 Gamecube 的启动画面上可能会有问题，因为立方体菜单会因方向键输入而旋转。如果你想在 Gamecube 的主菜单上使用 OSD，你可以先进入 Gamecube 的选项菜单，这样就不会造成干扰。

### 使用 IR 遥控器 ###

为了保持代码简单，GCVideo 只使用 IR 遥控器上的六个按钮。前四个被命名为"Up"、"Down"、"Left"和"Right"，可以像 Gamecube 控制器上的方向键一样在菜单中导航。其他两个是"Enter"和"Back"，用于进入或离开子菜单，类似于使用 Gamecube 控制器导航 OSD 时的 X 和 Y 按钮。

由于 IR 遥控器和系统上运行的游戏之间没有干扰，使用 IR 遥控器调出主菜单只需按"Enter"按钮，而不是复杂的按钮组合。当你进入 GCVideo 的 OSD 主菜单时，你也可以按住 IR 按钮来重置除遥控器按钮分配外的所有设置为默认值。

#### IR 按钮配置 ####

由于我不知道你想用什么遥控器与 GCVideo 一起使用，只要遥控器使用所谓的 NEC 协议，它就可以配置为接受任何 IR 遥控器按钮。要进入按钮配置屏幕，按住 IR 按钮直到配置屏幕出现，或在 OSD 设置子菜单中选择"IR key config..."选项。

![IR 配置菜单](doc/irconfig.png)

在配置屏幕上，你需要按顺序为屏幕上突出显示的每个功能按下遥控器上的六个按钮。如果你不小心试图将同一个按钮分配给两个不同的功能，GCVideo 会告诉你。如果按钮按下没有在此屏幕上得到"Ok"或"Dupe"的确认，你尝试使用的遥控器可能不兼容（或者你有接线错误或我的代码太严格）。

如果你想中止按钮分配，按一下 IR 按钮以恢复之前的按钮配置。

当你在主菜单上选择"Save settings"时，IR 遥控器按钮分配会与所有其他设置一起保存。

### 一般 OSD 使用 ###

GCVideo 的主菜单看起来像这样：

![GCVideo 主菜单](doc/mainmenu.png)

左侧的指示器标记当前选择的菜单选项。白色的行是可选择的选项，灰色的行是当前不可用的选项。如果需要，可以在 OSD 设置子菜单中更改背景颜色的透明度和颜色。

导航菜单很简单：你可以使用上下按钮更改当前选择，使用左右按钮更改值，使用游戏手柄上的 X 或 IR 遥控器上的 OK 激活选项，使用游戏手柄上的 Y 或 IR 遥控器上的 Back 退出。对于只在两个值之间切换的选项（例如"Off"和"On"或"Even"和"Odd"），你也可以使用游戏手柄上的 X 或 IR 遥控器上的 OK 进行切换。

主菜单的第一行（在标志下方）不是菜单选项，而是显示检测到的视频模式：240p、288p、480i、576i、480p、576p 或非标准模式的 NonStd。它下面的四个菜单项提供对当前模式的线倍频和扫描线设置的快速访问 - 根据模式，其中一些甚至全部可能不可用。这些菜单条目在下面的"View all modes"部分中有详细说明。

下面的大多数菜单条目都会进入子菜单，这些子菜单在下面有更详细的说明。"Store settings"条目将所有当前设置保存为新的开机默认值，"Exit"退出 OSD 菜单。

如果有疑问，可以尝试各种设置。你始终可以通过使用 L+R+X+Y+Start 调出 OSD 菜单来重置为默认值。这个重置功能是临时的 - 如果你想恢复已存储的设置，确保使用"Store settings"菜单项。

OSD 在主菜单之外还有一个额外功能：当来自 Gamecube 的视频信号分辨率发生变化时，一个信息弹出窗口会在右上角显示新信息五秒钟。这个弹出窗口可以在"OSD Settings..."子菜单中禁用。

### 扫描线设置 ###

GCVideo 可以选择性地使图像的部分区域变暗，以模拟 CRT 显示器上扫描线的外观。为了提供更大的灵活性，有三个扫描线配置文件，你可以根据需要将它们分配给支持的视频模式，并且可以根据需要自定义每个配置文件。

GCVideo 3 中的扫描线比之前使用的算法更灵活，之前的算法只是将亮度降低一个固定因子。新算法根据处理的原始像素的亮度来选择因子，所以通过在图像明亮部分减弱扫描线效果，可以实现类似于泛光的效果。

![扫描线设置菜单](doc/scanlines.png)

菜单中的第一行选择使用下面的设置更改哪个扫描线配置文件。如果选择的配置文件与当前模式使用的配置文件相同，它会在右侧用 * 标记，所有更改都会立即可见。

"Full Custom"选项是为那些想要对扫描线配置文件进行极其精细控制的人设计的。当它关闭时，扫描线的外观只由下面的"Brightness"和"Hybrid factor"选项控制。当"Full custom"开启时，这两个条目被禁用，你可以为每个可能的亮度值选择单独的扫描线亮度。

为了简化解释，让我们假设"Hybrid Factor"现在设置为 0.000。在这种情况下，扫描线效果的外观与输入像素的亮度无关，所以明亮和暗淡的输入像素都被相同的因子变暗。这个因子由"Brightness"菜单条目决定，范围从 0.000 到 1.000。因子为 0 会将每个受影响的像素变为黑色，因子为 1.000 会保持原样，实际上禁用了扫描线效果。这些限制之间的因子按比例使像素变暗。

"Hybrid Factor"菜单条目范围从 0.000 到 1.992，决定了扫描线效果对图像中明亮像素的减弱程度。如上所述，在 0.000 时禁用混合因子。当设置为 0.5 时，扫描线效果对最亮像素的强度减半，当混合因子为 1.000 时，它对这些像素完全消失。高于 1.000 的混合因子将扫描线效果消失的点移向较暗的像素，在最大值 1.992 时，约一半亮度的像素不受扫描线影响。

混合因子的实现受到/改编自/经许可借鉴自 Marqs 和 borti 的 OSSC 的混合扫描线，但由于实现差异，图像可能看起来略有不同。

"Luminance"菜单项始终处于活动状态，与"Full Custom"选项无关。其值可以从 16 到 235，决定在"Applied Factor"菜单项中访问/显示哪个因子。当"Full Custom"设置为关闭时，这可以用来检查由"Brightness"和"Hybrid Factor"菜单选项计算的扫描线强度表。

当"Full Custom"设置为开启时，最后一个菜单项"Applied Factor"变为可用。与"Luminance"菜单项一起，你可以编辑 GCVideo 用于实现扫描线效果的强度表中的每个条目。这里的值与"Brightness"值在"Hybrid Factor"设置为 0.000 时的工作方式相同，但它只影响在"Luminance"菜单项中设置的亮度值的像素。尽管你一次只能在此菜单中看到一个值，但实际上有一个完整的表格，包含所有从 16-235 的亮度的条目，你可以在这里一次编辑一个条目。当然，以图形形式编辑这样的表格会更好，但不幸的是这需要太多的 FPGA 资源，无法在 GCVideo 中实现。

请注意，关闭"Full Custom"并更改"Brightness"和"Hybrid Factor"中的任何一个都会将自定义表重置回计算值。完全自定义和普通扫描线配置文件都可以通过在主菜单中选择"Store Settings"与所有其他设置一起保存。

### 图像设置 ###

图像设置子菜单有控件来更改亮度、对比度和饱和度以及图像位置。

![图像设置菜单](doc/picture.png)

每个控件的范围从 -128 到 +127。当亮度、对比度和饱和度都设置为 0 时，图像完全按照控制台产生的方式输出，没有任何修改。

由于这些设置也会影响屏幕显示的外观，并且可能设置为使 OSD 完全不可读的值，图像设置菜单的操作方式与其他菜单略有不同：虽然所有更改都立即应用，但如果你使用 Y 或 Back 按钮或"Cancel"选项退出菜单，它们会重置为之前的值。要保留更改，你需要选择"Save and Exit"菜单选项。这仅适用于当前会话 - 要永久保存图像设置以及所有其他设置，在主菜单中选择"Store settings"。

请注意，此菜单中某些极端的设置组合可能导致错误的颜色输出，例如明亮的白色翻转为黑色或高度饱和的颜色中的色调偏移。如果遇到这种情况，建议的解决方法是在 GCVideo 中使用不那么极端的图像设置，最好是中性的。

"X Position"和"Y Position"设置更改游戏图像在屏幕上的位置。虽然它们的范围是从 -128 到 +127，但图像的实际位置受控制台生成的视频信号的限制。对于某些游戏或软件，即使你在这里选择非零设置，也可能无法移动图像。这个设置也被非标准视频模式忽略。

当检测到 GBI 的 486 行视频模式并且在输出设置中启用了"Crop 486 to 480"时，你可以使用"Y Position"设置在 GBI 的 486 行信号内移动 GCVideo 显示的 480 行窗口。

### OSD 设置 ###

OSD 设置菜单有一个选项可以禁用在控制台更改输出分辨率时显示五秒钟的模式弹出窗口，以及三个设置来更改 OSD 背景的颜色和透明度。

![OSD 设置菜单](doc/osd.png)

"BG Transparency"决定控制台的图像通过 OSD 显示的程度，范围从 0 到 255。在 0 时，控制台的图像完全不能通过 OSD 背景看到，在 255 时，控制台的图像完全可见，这可能导致如果 OSD 后面的图像非常明亮，可能会出现可读性问题。默认值是 80。

"BG Tint Blue"和"BG Tint Red"决定 OSD 背景的颜色。从技术上讲，它是 YCbCr 色彩空间中的 Cb+Cr 值，但在实践中，可能更容易尝试这些值以达到所需的颜色。默认值是 27 和 -8，这会产生深蓝色背景。

像往常一样，在此菜单中选择的设置可以使用主菜单上的"Store settings"条目存储为开机默认值。

此外，你可以通过选择"IR Key Config..."条目从此菜单进入 IR 按钮配置屏幕。

### 输出设置 ###

此菜单包含各种与输出相关的设置。默认值是为最大兼容性而不是最大便利性选择的，所以你可能想要更改其中的一些。

![输出设置菜单](doc/output.png)

"Allow 480p Mode"决定 GCVideo 是否向控制台发送逐行视频线缆存在的信号。如果在 Gamecube 上关闭此选项，游戏将永远不会询问你是否要使用逐行模式(*)；如果在 Wii 上关闭此选项，控制台设置中将不会提供 480p 模式选项。如果你使用只支持标清的显示器，关闭此选项可能很有用，因为一些自制软件在检测到逐行模式视频线缆存在时会默认使用 480p。在某些硬件实现上，无论在这里设置什么，存在信号始终启用。

"Crop 486 to 480"是一个特殊选项，用于从 GBI 的 486 行视频模式生成标准的 480 行图像。只要它被禁用，GBI 的特殊 486 行模式就会按原样传递。如果它被启用并且检测到其中一个特殊模式，图像会被裁剪到 480 行，这改善了与某些显示器的兼容性。

"RGB Limited Range"决定 GCVideo 在其数字输出上输出有限范围（"On"）还是全范围（"Off"）RGB 信号。如果在高级菜单中选择了 YCbCr 输出，此选项可能被禁用。请查看下面的词汇表以了解有关有限和全范围 RGB 信号的解释。它默认为全范围，因为默认输出是标准 DVI，它始终是全范围。

"Enhanced DVI Mode"选择数字输出是传输标准 DVI（"Off"）还是包含额外元数据和音频信号的增强版本，后者与严格遵循标准的 DVI 输入不兼容。此选项默认为关闭，因为如果你没有得到任何音频，打开它比在你没有得到任何图像时关闭它更容易。

当"Enhanced DVI Mode"为开启时，"Display as 16:9"选项变为可用。如果打开，它告诉显示器信号应该以 16:9 宽高比显示。一些显示器（和缩放器）会根据设置自动在 16:9 和 4:3 宽高比之间切换，一些则忽略它。

"Volume"降低音频音量，范围从 0（静音）到 255（原始信号）。此设置只影响 GCVideo 自己输出的音频，不影响控制台的 Multi-AV。下面的"Mute"可以用来临时静音控制台的音频，而不必通过音量设置的整个范围调低。

具有额外模拟视频输出的硬件实现在这里显示一个菜单项"Analog Output"，用于选择模拟视频信号格式。"YPbPr"输出分量视频，"RGB"输出 RGB，"RGsB"输出带绿同步的 RGB。请注意，高级选项菜单中的某些设置可能会阻止 RGB/RGsB 工作。

像往常一样，在此菜单中选择的设置可以使用主菜单上的"Store Settings"条目存储为开机默认值。

(*) 请注意，大多数 PAL 区域的 Gamecube 游戏根本不提供逐行视频选项。对于 NTSC 区域的游戏，你可能需要在游戏启动时按住 B 才能让关于逐行模式的问题出现。第三方软件如 [Swiss](https://github.com/emukidid/swiss-gc) 有时可以强制 PAL 区域的游戏输出逐行视频。

### 查看所有模式 ###

如前所述，主菜单屏幕上的前四个条目是特定于当前视频模式的。由于在控制台上循环所有模式来配置每个模式会很不方便，"View All Modes"菜单让你选择要更改哪个模式的设置。由于在非标准模式下无法更改任何这些设置，因此模式菜单中没有 NonStd 条目。

![查看所有模式菜单](doc/allmodes.png)

每个模式菜单都有一个启用或禁用线倍频器的条目以及与扫描线相关的设置。根据模式，某些设置可能被禁用。

![单个模式设置](doc/singlemode.png)

"Linedoubler"在 240p、288p、480i 和 576i 中可用。如果启用，GCVideo 会输出每个视频行两次，这会导致 480p 或 576p 的输出。它默认对所有模式启用以提高兼容性，但如果你的显示器通过数字连接接受 480i/576i 模式，建议对这些模式关闭线倍频器，因为这可能会导致更高的图像质量。有关线倍频与去隔行的更多详细信息，请查看词汇表。

扫描线选项仅在 480p 和 576p 模式下可用，或者在 240p/288p/480i/576i 模式启用线倍频器时可用。要禁用扫描线，只需将"Scanline Profile"设置为"Off"。否则，所选配置文件会根据其下方的设置应用到图像上。

"Apply to"选择是在奇数还是偶数视频行上应用扫描线，启用"Alternating Scanlines"在每帧之间交替使用偶数和奇数视频行。通过为 480i/576i 启用线倍频器并以适度强度打开交替扫描线，有时可以为隔行视频实现类似 CRT 的效果。

像往常一样，在此菜单中选择的设置可以使用主菜单上的"Store Settings"条目存储为开机默认值。

### 高级设置 ###

此子菜单中的设置仅适用于高级用户，因为它们可能降低音频和/或图像质量或降低输出信号与显示器的兼容性。另一方面，更改这里的一些设置可能允许你使用拒绝与默认设置合作的显示器，尽管可能会降低输出质量。

![高级设置菜单](doc/advanced.png)

"Chroma Interpolation"默认开启。如果你关闭它，输出图像将有轻微的颜色偏移以及颜色过渡上更强的阶梯/像素化。

"Fix Resolution"默认开启。当它开启时，GCVideo 在控制台的图像上应用黑色边框以扩展到符合标准的分辨率。许多游戏以略微降低的分辨率输出图片，因为图像的边缘通常在 CRT 显示器上不可见，不在那里渲染可以节省一点图形处理能力。通过禁用此选项，GCVideo 的输出信号不再符合相关标准，这可能导致某些显示器或缩放器出现问题 - 例如我的一台电视总是将这样的信号缩放到完整面板大小并禁用其宽高比选项。

"Fix Sync Timing"默认开启，只在"Fix Resolution"开启时可用。它修改同步信号的时序以符合标准。几乎没有理由关闭它，它在这里主要是为了完整性。如果此选项关闭，图像菜单中的 X/Y 位置选项将没有效果。

"Regenerate CSync"默认关闭，只与具有模拟输出的硬件相关。它决定当线倍频器关闭时，CSync 信号（无论是离散的还是包含在 YPbPr 的 Y 中或 RGsB 的 G 中）是从控制台传递还是始终从 HSync 和 VSync 重新生成。重新生成的信号没有锯齿和均衡脉冲，这可能导致图像顶部出现失真。如果此选项设置为关闭，图像菜单中的 X/Y 位置选项可能对模拟输出没有效果。

"Digital Color Format"只在输出设置菜单中启用"Enhanced DVI Mode"时可用。当它可用时，选项是"RGB-F"、"RGB-L"、"YC444"和"YC422"。前两个代表全范围和有限范围 RGB，与输出菜单中的 RGB 有限范围切换具有相同的效果。最后两个选项选择 YCbCr 输出，分别使用 4:4:4 或 4:2:2 色度下采样（详见词汇表），可能不是所有显示器都兼容。甚至有些显示器在某些模式下接受 YCbCr 颜色，但在其他模式下不接受。在这里选择 YC444 或 YC422 可能会导致辅助模拟输出（如果有）上的颜色不正确。

"Report 240p as 480i"默认关闭。由于 240p/288p 模式作为数字信号不太常见，一些显示器可能无法识别它们的官方模式编号。打开此选项会更改在显示非线倍频的 240p/288p 模式时发送的元数据：不是发送正确的模式编号，GCVideo 使用 480i/576i 的编号。我不确定这在实践中是否有用 - 这是一个尝试让我的一个显示器在 240p 模式下接受元数据，但没有成功。

"Sample Rate Hack"默认关闭，只与 Gamecube 或在 Gamecube 模式下的 Wii 相关。由于控制台硬件中的一个差一错误，Gamecube 的音频采样率不是标准的 48.000Hz，而是 48.042Hz。这仍然（勉强）在 SPDIF 的官方容差范围内，但有报告称在较长时间后可能出现音频/视频漂移，这可能是由这个差异引起的。如果你打开此选项，通过偶尔丢弃一个样本，输出采样率被强制为精确的 48.000Hz，这会引入轻微的模糊或爆音伪影，根据正在播放的声音可能听得到也可能听不到。如果你打开了此选项，请不要报告任何关于失真音频的错误。

像往常一样，在此菜单中选择的设置可以使用主菜单上的"Store Settings"条目存储为开机默认值。

### 关于 ###

关于屏幕显示固件版本、当前控制台模式（在 Wii 上）并有一个选项可以启动固件更新工具，这在下面有描述。

![关于屏幕](doc/about.png)

## 更新 ##

GCVideo 包含一个用于刷新更新的工具，可以通过在关于菜单中选择"Update Firmware..."选项或在打开控制台时按住 IR 按钮来访问。当 GCVideo 检测到主固件损坏或丢失时，更新工具也会自动启动。

当更新工具运行时，GCVideo 在受限模式下运行，只提供最小功能且几乎不可配置：
* 图像始终为黑白
* 没有音频
* 数字输出始终输出 480p/576p 图像，如果控制台使用 480i/576i 模式则使用线倍频
* 模拟输出（如果有）始终输出 480i/576i 图像
* 模拟输出（如果有）始终输出分量视频信号，但如果你使用 RGB 连接，它可能仍会产生可见（但颜色奇怪）的图像
* 除了 IR 遥控器按钮代码外，主固件中的设置被忽略
* 除了可以通过长按 IR 按钮激活的 IR 遥控器配置菜单外，不存在用户可配置的选项

要使用更新工具，你需要能够在 Gamecube 或 Wii 上运行 .dol 格式的自制软件。在进入刷新工具之前或之后启动带有固件更新的 .dol 都无所谓。

刷新工具持续扫描视频信号以查找有效的更新数据。如果它找到适用于你安装的硬件的更新，它会询问你是否要安装它，显示当前固件和它可以为你安装的固件的版本号。

要在提示时实际安装固件，按住游戏手柄上的 X 和 Y 按钮或按 IR 遥控器上的 OK 按钮。更新安装后，GCVideo 将自动重启。如果你想退出刷新工具而不安装更新，按游戏手柄上的开始按钮或 IR 遥控器上的 Back 按钮。

理论上，即使在安装固件更新期间断电，通过安装固件更新也不可能使 GCVideo 变砖：即使主固件不启动，你始终可以通过在打开控制台时按住 IR 按钮来强制启动刷新工具。在实践中，已观察到理论和实践可能有所不同，所以不能保证一切都会按这里描述的方式工作。

## 诊断模式 ##

固件更新模式还包括一个诊断工具，可用于检查 GCVideo 安装的某些方面是否正确连接。通过在关于菜单中选择"Update firmware..."选项并按游戏手柄上的 R 扳机或 IR 遥控器上的 Right 来访问它。目前只有在你能看到图像的情况下才能使用它。

![诊断模式](doc/diagmode.png)

诊断模式检查所有八条视频线是否工作以及三条音频线上是否有活动。视频线检查需要屏幕上有特殊的测试图案，该图案从 GCVideo-DVI 版本 3.0d 开始集成在 updater.dol 中，在屏幕顶部有特定的颜色渐变。音频线检查只需要播放任何音频，例如控制台主菜单屏幕的背景音乐。从 GCVideo 发布 3.0e（updater 版本 1.2）开始，updater.dol 播放极其安静的白噪声，以确保可以测试这个信号。

当诊断模式检测到测试图案时，它会通过显示"Test pattern detected"来确认。如果一切正确，下面的三行都应该显示"None"。如果不是，它们将显示似乎有问题的 VData 线的编号。列为"stuck at 0/1"的线可能未连接或与不相关的信号短路。"Unexpected bits"中列出的任何内容可能与另一条线或不相关的信号交换或短路。

请注意，即使在完全正常工作的安装中，如果屏幕上没有显示测试图案，"Unexpected bits"输出几乎肯定会是"01234567"。即使没有测试图案，"Bits stuck"测试可能仍然给出有效结果，但已知根据屏幕内容会导致误检 - 例如，完全黑色的屏幕可能错误地在"stick at 0"诊断中检测到"0123 56"。

音频诊断检查三个音频信号是否在切换，以及它们是否有意外的毛刺，例如由串扰引起的。如果信号完全没有切换，它将被列为"Missing" - 但请注意，如果控制台的音频是静音的，AData 也会显示这个。

如果检测到毛刺，每帧的毛刺数量会在括号中显示 - 对于 AData，即使是完美的安装也可能由于未知情况显示少量毛刺。毛刺可能是由多个信号之间的干扰引起的，重新布线时保持更大的间隔或仅仅改变它们之间的角度有时可能对检测到的毛刺数量产生重大影响。

## 词汇表 ##

本节包含一些与 GCVideo 相关的概念的解释，这些概念在主手册部分中过于冗长而无法直接解释。

### 全范围和有限范围 RGB ###

由于历史原因，通过数字接口发送的 RGB 颜色值有两种解释。一种解释是使用 0 作为黑色，255 作为最亮的红/绿/蓝。这种变体源于计算机图形中的使用，称为全范围 RGB，因为它使用了完整的数字范围。

另一种解释使用 16 作为黑色，235 作为最亮的红/绿/蓝 - 低于/高于该值的值通常显示为黑色或最亮的红/绿/蓝。这可能看起来很奇怪，但它源于用于将 YCbCr 色彩空间转换为 RGB 的公式，因此在广播视频中常用。它被称为有限范围 RGB，因为它只使用可能的数值范围的一部分。

GCVideo 可以输出其中任何一种，你应该选择哪一种取决于接收端的期望。如果选择错误，图像的对比度会发生变化：将全范围 RGB 发送到期望有限范围的输入起初看起来像更高对比度的图像，但图像最暗和最亮的部分都会失去细节，因为它们超出了允许值的范围。在另一种情况下，将有限范围信号发送到期望全范围的输入，对比度降低，这确实保留了所有区域的细节，但看起来褪色。

理论上，当打开增强 DVI 选项时，这个选择并不重要，因为视频信息数据中有一个位告诉接收器图像应该是全范围还是有限范围。在实践中，并非每个接收器都检查该位，所以在某些显示器/缩放器/等上需要在其菜单中手动选择 RGB 范围。选项的命名可能并不总是明显，例如一些三星电视将其称为"HDMI Black Level"，其中"Low"表示有限范围，"Normal"表示全范围。

你选择这两个选项中的哪一个并不重要，只要接收端使用相同的选择即可。如果你有一个需要手动选择的显示器，并且通过 HDMI 开关馈送它，你可能想确保连接到该开关的所有源使用相同的设置 - 但要注意，有些源不允许你做出这个选择，例如 Wii U 通过其 HDMI 输出始终输出有限范围 RGB。

### 线倍频与去隔行 ###

线倍频是一个相对简单的过程：每个输入视频行输出两次，速度加倍。这使垂直分辨率加倍，实现非常简单，因为只需要存储两行。然而，当应用于隔行材料时，这是一个非常丑陋的方法，因为它会导致闪烁和抖动的图像。另一方面，闪烁和抖动的图像仍然比没有图像好，特别是因为 Gamecube 的系统菜单始终输出隔行图像。

要从隔行信号正确生成逐行信号，去隔行器会用前一场的数据而不是前一行的副本来填充新生成的行。然而，这需要更多内存，因为至少必须存储整个前一场。[维基百科](https://en.wikipedia.org/wiki/Deinterlacing)有关于去隔行的更详细讨论。

### 4:2:2 和 4:4:4 颜色 ###

这两组数字指定相对于视频信号亮度分辨率的颜色分辨率。4:4:4 意味着每个像素都有自己的亮度和颜色数据，4:2:2 意味着每个像素都有自己的亮度，但颜色数据由两个像素组共享。这被称为[色度子采样](https://en.wikipedia.org/wiki/Chroma_subsampling)，除了这两种之外还有更多变体，但与 GCVideo 无关。